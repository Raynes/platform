<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
  <meta content="width=device-width; initial-scale=1.0; maximum-scale=1.0; minimum-scale=1.0; user-scalable=0;" name="viewport">
</head>
<body style="margin:0px;">
  <div style="width:100%; margin-bottom:0px;">
    <div style="background:url('/platform/images/oauth/perm_tile.gif'); height:10px;">&nbsp;</div>
    
		<div style="margin:10px; text-align:left;">
			<div style="border-bottom:1px solid #ccc; font-size:14px; font-weight:bold;">
				<%=trl("Authorization Request")%>
			</div>
			
			<div style="margin-top:10px;margin-bottom:10px;font-size:11px;">
		    <%=trl("{application} is requesting permission to access your Geni account.", "API permission", {:application => link_to(@client_application.name, :controller => '/platform/apps', :action => :view, :app_id => @client_application.id)}) %>
      </div>
			
      <div style="padding:10px;">
				<table style="width:100%">
					<tr>
						<td style="font-size:10px;">
							<%=image_tag(Platform::Config.user_mugshot(Platform::Config.current_user), :style => "float:left; padding-right:15px;")%>
              <div style="font-weight:bold;">Access to my profile information</div>
              <div style="margin-top:10px; color:#666; padding-right:15px; ">
                 <%=trl("Includes name, profile picture, gender, family, photos and any other information available through my user account.")%>
              </div>
						</td>
						<td style="vertical-align:middle">
							<%=image_tag("/platform/images/oauth/right_grey.png")%>
						</td>	
						<td style="vertical-align:top;">
	             <div style="height:130px; padding:5px; margin:3px; text-align:center;">
	                <div style="">
	                   <%= image_tag(@client_application.logo_url, :class => "icn projects_icn img", :style => "width:75px;height:75px;") %>
	                </div> 
	                <div style="font-size:12px; padding-top:10px;">
	                  <%= link_to(h(@client_application.name), {:action => :view, :id => @client_application.id}) %><br>
	                </div>
	                <div style="font-size:11px; padding-top:10px; white-space: nowrap">
	                 <%= platform_app_rank_tag(@client_application, 95) %>
	                </div>
	             </div>
						</td>
					</tr>
				</table>
      </div>
			  
      <div style="margin-top:10px; color: #888; font-size:10px;">
        <%=tr("By proceeding, you agree to the {application} [link1: Terms of Service] and [link2: Privacy Policy].", "", :application => @client_application.name, :link1 => [@client_application.terms_of_service_url], :link2 => [@client_application.privacy_policy_url])%>
			</div>
		</div>
		
		<div style="background:#eee; text-align:left; padding:10px; vertical-align:middle; position:fixed; width:95%; bottom:0px;">
		  <table style="width:100%">
		  	<tr>
		  		<td style='text-align:left; vertical-align:middle; font-size:10px;'>
            <%= link_to(tr('Not {user}?', 'Client application action label', :user => [own_profile, :name]), '/logout') %>
		  		</td>
					<td style='text-align:right;font-size:10px;'>
						 <button onClick="$('authorize').value = 1; $S('auth_form')" style="font-size:13px;">
						 	<%=trl('Allow', 'Client application action label')%>
						 </button>
	           <button onClick="$('authorize').value = 0; $S('auth_form')" style="font-size:13px;">
	            <%=trl("Don't Allow", 'Client application action label')%>
	           </button>
					</td>
		  	</tr>
		  </table>
		</div>	
  </div>


<%= render :partial => "authorize_form" %>

<script>
  function $(element_id) {
    if (typeof element_id == 'string') return document.getElementById(element_id);
    return element_id;
  }
	
	function $S(element_id) {
    $(element_id).submit();		
	} 
</script>  

</body>
</html>
